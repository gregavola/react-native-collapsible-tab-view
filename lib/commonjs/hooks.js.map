{"version":3,"names":["useContainerRef","useAnimatedDynamicRefs","map","setMap","setRef","key","ref","useTabProps","children","tabType","options","tabOptions","Map","Children","forEach","element","index","type","Error","name","props","has","set","optionEntries","Array","from","entries","optionKeys","keys","memoizedOptions","memoizedTabNames","useTabsContext","c","Context","useTabNameContext","TabNameContext","useLayoutHeight","initialHeight","height","setHeight","getHeight","event","latestHeight","nativeEvent","layout","useCollapsibleStyle","headerHeight","tabBarHeight","containerHeight","width","allowHeaderOverscroll","minHeaderHeight","containerHeightWithMinHeader","Math","max","style","contentContainerStyle","minHeight","IS_IOS","paddingTop","progressViewOffset","useUpdateScrollViewContentSize","tabNames","contentHeights","setContentHeights","tabIndex","value","indexOf","scrollContentSizeChange","_","h","useChainCallback","fns","callAll","args","fn","useScroller","contentInset","scroller","x","y","animated","_debugKey","useScrollHandlerY","accDiffClamp","focusedTab","snapThreshold","revealHeaderOnScroll","refMap","scrollYCurrent","scrollY","oldAccScrollY","accScrollY","offset","headerScrollDistance","snappingTo","indexDecimal","enabled","scrollTo","enable","toggle","afterDrag","scrollAnimation","undefined","val","onMomentumEnd","scrollHandler","onScroll","contentOffset","contentHeight","Number","MAX_VALUE","clampMax","Extrapolation","CLAMP","delta","nextValue","min","onBeginDrag","onEndDrag","ONE_FRAME_MS","duration","isFinished","onMomentumBegin","isChangingPane","isInteger","isSyncNeeded","wasSyncNeeded","nextPosition","focusedScrollY","tabScrollY","areEqual","currIsOnTop","StyleSheet","hairlineWidth","focusedIsOnTop","hasGap","useSharedAnimatedRef","outerRef","current","useAfterMountEffect","nextOnLayout","effect","didExecute","didMount","prevDidMount","onLayoutOut","requestAnimationFrame","useConvertAnimatedToValue","animatedValue","setValue","animValue","useHeaderMeasurements","headerTranslateY","top","useCurrentTabScrollY","useFocusedTab","focusedTabValue","useAnimatedTabIndex","usePageScrollHandler","handlers","dependencies","context","doDependenciesDiffer","subscribeForEvents","onPageScroll","eventName","endsWith"],"sources":["hooks.tsx"],"sourcesContent":["import {\n  useMemo,\n  Children,\n  useState,\n  useCallback,\n  useContext,\n  MutableRefObject,\n  useEffect,\n  useRef,\n} from 'react'\nimport { LayoutChangeEvent, StyleSheet, ViewProps } from 'react-native'\nimport { ContainerRef, RefComponent } from 'react-native-collapsible-tab-view'\nimport { PagerViewOnPageScrollEvent } from 'react-native-pager-view'\nimport Animated, {\n  cancelAnimation,\n  useAnimatedReaction,\n  useAnimatedRef,\n  useAnimatedScrollHandler,\n  useSharedValue,\n  withDelay,\n  withTiming,\n  interpolate,\n  runOnJS,\n  runOnUI,\n  useEvent,\n  useHandler,\n  AnimatedRef,\n  Extrapolation,\n} from 'react-native-reanimated'\nimport { useDeepCompareMemo } from 'use-deep-compare'\n\nimport { Context, TabNameContext } from './Context'\nimport { IS_IOS, ONE_FRAME_MS, scrollToImpl } from './helpers'\nimport {\n  CollapsibleStyle,\n  ContextType,\n  TabName,\n  TabReactElement,\n  TabsWithProps,\n} from './types'\n\nexport function useContainerRef() {\n  return useAnimatedRef<ContainerRef>()\n}\n\nexport function useAnimatedDynamicRefs(): [\n  ContextType['refMap'],\n  ContextType['setRef'],\n] {\n  const [map, setMap] = useState<ContextType['refMap']>({})\n  const setRef = useCallback((key: TabName, ref: AnimatedRef<RefComponent>) => {\n    setMap((map) => ({ ...map, [key]: ref }))\n    return ref\n  }, [])\n\n  return [map, setRef as ContextType['setRef']]\n}\n\nexport function useTabProps<T extends TabName>(\n  children: TabReactElement<T>[] | TabReactElement<T>,\n  tabType: Function\n): [TabsWithProps<T>, T[]] {\n  const options = useMemo(() => {\n    const tabOptions: TabsWithProps<T> = new Map()\n    if (children) {\n      Children.forEach(children, (element, index) => {\n        if (!element) return\n\n        if (element.type !== tabType)\n          throw new Error(\n            'Container children must be wrapped in a <Tabs.Tab ... /> component'\n          )\n\n        // make sure children is excluded otherwise our props will mutate too much\n        const { name, children, ...options } = element.props\n        if (tabOptions.has(name))\n          throw new Error(`Tab names must be unique, ${name} already exists`)\n\n        tabOptions.set(name, {\n          index,\n          name,\n          ...options,\n        })\n      })\n    }\n    return tabOptions\n  }, [children, tabType])\n  const optionEntries = Array.from(options.entries())\n  const optionKeys = Array.from(options.keys())\n  const memoizedOptions = useDeepCompareMemo(() => options, [optionEntries])\n  const memoizedTabNames = useDeepCompareMemo(() => optionKeys, [optionKeys])\n  return [memoizedOptions, memoizedTabNames]\n}\n\n/**\n * Hook exposing some useful variables.\n *\n * ```tsx\n * const { focusedTab, ...rest } = useTabsContext()\n * ```\n */\nexport function useTabsContext(): ContextType<TabName> {\n  const c = useContext(Context)\n  if (!c) throw new Error('useTabsContext must be inside a Tabs.Container')\n  return c\n}\n\n/**\n * Access the parent tab screen from any deep component.\n *\n * ```tsx\n * const tabName = useTabNameContext()\n * ```\n */\nexport function useTabNameContext(): TabName {\n  const c = useContext(TabNameContext)\n  if (!c) throw new Error('useTabNameContext must be inside a TabNameContext')\n  return c\n}\n\nexport function useLayoutHeight(initialHeight: number = 0) {\n  const [height, setHeight] = useState(initialHeight)\n\n  const getHeight = useCallback(\n    (event: LayoutChangeEvent) => {\n      const latestHeight = event.nativeEvent.layout.height\n      if (latestHeight !== height) {\n        setHeight(latestHeight)\n      }\n    },\n    [height, setHeight]\n  )\n  return [height, getHeight] as const\n}\n/**\n * Hook to access some key styles that make the whole thing work.\n *\n * You can use this to get the progessViewOffset and pass to the refresh control of scroll view.\n */\nexport function useCollapsibleStyle(): CollapsibleStyle {\n  const {\n    headerHeight,\n    tabBarHeight,\n    containerHeight,\n    width,\n    allowHeaderOverscroll,\n    minHeaderHeight,\n  } = useTabsContext()\n  const containerHeightWithMinHeader = Math.max(\n    0,\n    (containerHeight ?? 0) - minHeaderHeight\n  )\n\n  return useMemo(\n    () => ({\n      style: { width },\n      contentContainerStyle: {\n        minHeight:\n          IS_IOS && !allowHeaderOverscroll\n            ? containerHeightWithMinHeader - (tabBarHeight || 0)\n            : containerHeightWithMinHeader + (headerHeight || 0),\n        paddingTop:\n          IS_IOS && !allowHeaderOverscroll\n            ? 0\n            : (headerHeight || 0) + (tabBarHeight || 0),\n      },\n      progressViewOffset:\n        // on iOS we need the refresh control to be at the top if overscrolling\n        IS_IOS && allowHeaderOverscroll\n          ? 0\n          : // on android we need it below the header or it doesn't show because of z-index\n            (headerHeight || 0) + (tabBarHeight || 0),\n    }),\n    [\n      allowHeaderOverscroll,\n      headerHeight,\n      tabBarHeight,\n      width,\n      containerHeightWithMinHeader,\n    ]\n  )\n}\n\nexport function useUpdateScrollViewContentSize({ name }: { name: TabName }) {\n  const { tabNames, contentHeights } = useTabsContext()\n  const setContentHeights = useCallback(\n    (name: TabName, height: number) => {\n      'worklet'\n      const tabIndex = tabNames.value.indexOf(name)\n      contentHeights.value[tabIndex] = height\n      contentHeights.value = [...contentHeights.value]\n    },\n    [contentHeights, tabNames]\n  )\n\n  const scrollContentSizeChange = useCallback(\n    (_: number, h: number) => {\n      runOnUI(setContentHeights)(name, h)\n    },\n    [setContentHeights, name]\n  )\n\n  return scrollContentSizeChange\n}\n\n/**\n * Allows specifying multiple functions to be called in a sequence with the same parameters\n * Useful because we handle some events and need to pass them forward so that the caller can handle them as well\n * @param fns array of functions to call\n * @returns a function that once called will call all passed functions\n */\nexport function useChainCallback(fns: (Function | undefined)[]) {\n  const callAll = useCallback(\n    (...args: unknown[]) => {\n      fns.forEach((fn) => {\n        if (typeof fn === 'function') {\n          fn(...args)\n        }\n      })\n    },\n    [fns]\n  )\n  return callAll\n}\n\nexport function useScroller<T extends RefComponent>() {\n  const { contentInset } = useTabsContext()\n\n  const scroller = useCallback(\n    (\n      ref: AnimatedRef<T> | undefined,\n      x: number,\n      y: number,\n      animated: boolean,\n      _debugKey: string\n    ) => {\n      'worklet'\n      if (!ref) return\n      //! this is left here on purpose to ease troubleshooting (uncomment when necessary)\n      // console.log(\n      //   `${_debugKey}, y: ${y}, y adjusted: ${y - contentInset}`\n      // )\n      scrollToImpl(ref, x, y - contentInset, animated)\n    },\n    [contentInset]\n  )\n\n  return scroller\n}\n\nexport const useScrollHandlerY = (name: TabName) => {\n  const {\n    accDiffClamp,\n    focusedTab,\n    snapThreshold,\n    revealHeaderOnScroll,\n    refMap,\n    tabNames,\n    headerHeight,\n    contentInset,\n    containerHeight,\n    scrollYCurrent,\n    scrollY,\n    oldAccScrollY,\n    accScrollY,\n    offset,\n    headerScrollDistance,\n    snappingTo,\n    contentHeights,\n    indexDecimal,\n    allowHeaderOverscroll,\n  } = useTabsContext()\n\n  const enabled = useSharedValue(false)\n\n  const scrollTo = useScroller()\n\n  const enable = useCallback(\n    (toggle: boolean) => {\n      'worklet'\n      enabled.value = toggle\n    },\n    [name, refMap, scrollTo]\n  )\n\n  /**\n   * Helper value to track if user is dragging on iOS, because iOS calls\n   * onMomentumEnd only after a vigorous swipe. If the user has finished the\n   * drag, but the onMomentumEnd has never triggered, we need to manually\n   * call it to sync the scenes.\n   */\n  const afterDrag = useSharedValue(0)\n\n  const scrollAnimation = useSharedValue<number | undefined>(undefined)\n\n  useAnimatedReaction(\n    () => scrollAnimation.value,\n    (val) => {\n      if (val !== undefined) {\n        scrollTo(refMap[name], 0, val, false, '[useAnimatedReaction scroll]')\n      }\n    }\n  )\n\n  const onMomentumEnd = () => {\n    'worklet'\n    if (!enabled.value) return\n\n    if (typeof snapThreshold === 'number') {\n      if (revealHeaderOnScroll) {\n        if (accDiffClamp.value > 0) {\n          if (\n            scrollYCurrent.value >\n            headerScrollDistance.value * snapThreshold\n          ) {\n            if (\n              accDiffClamp.value <=\n              headerScrollDistance.value * snapThreshold\n            ) {\n              // snap down\n              accDiffClamp.value = withTiming(0)\n            } else if (accDiffClamp.value < headerScrollDistance.value) {\n              // snap up\n              accDiffClamp.value = withTiming(headerScrollDistance.value)\n\n              if (scrollYCurrent.value < headerScrollDistance.value) {\n                scrollAnimation.value = scrollYCurrent.value\n                scrollAnimation.value = withTiming(headerScrollDistance.value)\n                //console.log('[${name}] sticky snap up')\n              }\n            }\n          } else {\n            accDiffClamp.value = withTiming(0)\n          }\n        }\n      } else {\n        if (\n          scrollYCurrent.value <=\n          headerScrollDistance.value * snapThreshold\n        ) {\n          // snap down\n          snappingTo.value = 0\n          scrollAnimation.value = scrollYCurrent.value\n          scrollAnimation.value = withTiming(0)\n          //console.log('[${name}] snap down')\n        } else if (scrollYCurrent.value <= headerScrollDistance.value) {\n          // snap up\n          snappingTo.value = headerScrollDistance.value\n          scrollAnimation.value = scrollYCurrent.value\n          scrollAnimation.value = withTiming(headerScrollDistance.value)\n          //console.log('[${name}] snap up')\n        }\n      }\n    }\n  }\n\n  const scrollHandler = useAnimatedScrollHandler(\n    {\n      onScroll: (event) => {\n        if (!enabled.value) return\n\n        if (focusedTab.value === name) {\n          if (IS_IOS) {\n            let { y } = event.contentOffset\n            // normalize the value so it starts at 0\n            y = y + contentInset\n\n            const contentHeight =\n              contentHeights.value[tabNames.value.indexOf(name)] ||\n              Number.MAX_VALUE\n\n            const clampMax =\n              contentHeight - (containerHeight || 0) + contentInset\n            // make sure the y value is clamped to the scrollable size (clamps overscrolling)\n            scrollYCurrent.value = allowHeaderOverscroll\n              ? y\n              : interpolate(\n                  y,\n                  [0, clampMax],\n                  [0, clampMax],\n                  Extrapolation.CLAMP\n                )\n          } else {\n            const { y } = event.contentOffset\n            scrollYCurrent.value = y\n          }\n\n          scrollY.value[name] = scrollYCurrent.value\n          oldAccScrollY.value = accScrollY.value\n          accScrollY.value = scrollY.value[name] + offset.value\n\n          if (revealHeaderOnScroll) {\n            const delta = accScrollY.value - oldAccScrollY.value\n            const nextValue = accDiffClamp.value + delta\n            if (delta > 0) {\n              // scrolling down\n              accDiffClamp.value = Math.min(\n                headerScrollDistance.value,\n                nextValue\n              )\n            } else if (delta < 0) {\n              // scrolling up\n              accDiffClamp.value = Math.max(0, nextValue)\n            }\n          }\n        }\n      },\n      onBeginDrag: () => {\n        if (!enabled.value) return\n\n        // ensure the header stops snapping\n        cancelAnimation(accDiffClamp)\n\n        if (IS_IOS) cancelAnimation(afterDrag)\n      },\n      onEndDrag: () => {\n        if (!enabled.value) return\n\n        if (IS_IOS) {\n          // we delay this by one frame so that onMomentumBegin may fire on iOS\n          afterDrag.value = withDelay(\n            ONE_FRAME_MS,\n            withTiming(0, { duration: 0 }, (isFinished) => {\n              // if the animation is finished, the onMomentumBegin has\n              // never started, so we need to manually trigger the onMomentumEnd\n              // to make sure we snap\n              if (isFinished) {\n                onMomentumEnd()\n              }\n            })\n          )\n        }\n      },\n      onMomentumBegin: () => {\n        if (!enabled.value) return\n\n        if (IS_IOS) {\n          cancelAnimation(afterDrag)\n        }\n      },\n      onMomentumEnd,\n    },\n    [\n      refMap,\n      name,\n      revealHeaderOnScroll,\n      containerHeight,\n      contentInset,\n      snapThreshold,\n      enabled,\n      scrollTo,\n    ]\n  )\n\n  // sync unfocused scenes\n  useAnimatedReaction(\n    () => {\n      // if (!enabled.value) {\n      //   return false\n      // }\n\n      // if the index is decimal, then we're in between panes\n      const isChangingPane = !Number.isInteger(indexDecimal.value)\n\n      return isChangingPane\n    },\n    (isSyncNeeded, wasSyncNeeded) => {\n      if (\n        isSyncNeeded &&\n        isSyncNeeded !== wasSyncNeeded &&\n        focusedTab.value !== name\n      ) {\n        let nextPosition: number | null = null\n        const focusedScrollY = scrollY.value[focusedTab.value]\n        const tabScrollY = scrollY.value[name]\n        const areEqual = focusedScrollY === tabScrollY\n\n        if (!areEqual) {\n          const currIsOnTop =\n            tabScrollY + StyleSheet.hairlineWidth <= headerScrollDistance.value\n          const focusedIsOnTop =\n            focusedScrollY + StyleSheet.hairlineWidth <=\n            headerScrollDistance.value\n\n          if (revealHeaderOnScroll) {\n            const hasGap = accDiffClamp.value > tabScrollY\n            if (hasGap || currIsOnTop) {\n              nextPosition = accDiffClamp.value\n            }\n          } else if (typeof snapThreshold === 'number') {\n            if (focusedIsOnTop) {\n              nextPosition = snappingTo.value\n            } else if (currIsOnTop) {\n              nextPosition = headerHeight || 0\n            }\n          } else if (currIsOnTop || focusedIsOnTop) {\n            nextPosition = Math.min(focusedScrollY, headerScrollDistance.value)\n          }\n        }\n\n        if (nextPosition !== null) {\n          // console.log(`sync ${name} ${nextPosition}`)\n          scrollY.value[name] = nextPosition\n          scrollTo(refMap[name], 0, nextPosition, false, `[${name}] sync pane`)\n        }\n      }\n    },\n    [revealHeaderOnScroll, refMap, snapThreshold, enabled, scrollTo]\n  )\n\n  return { scrollHandler, enable }\n}\n\ntype ForwardRefType<T> =\n  | ((instance: T | null) => void)\n  | MutableRefObject<T | null>\n  | null\n\n/**\n * Magic hook that creates a multicast ref. Useful so that we can both capture the ref, and forward it to callers.\n * Accepts a parameter for an outer ref that will also be updated to the same ref\n * @param outerRef the outer ref that needs to be updated\n * @returns an animated ref\n */\nexport function useSharedAnimatedRef<T extends RefComponent>(\n  outerRef: ForwardRefType<T>\n) {\n  const ref = useAnimatedRef<T>()\n\n  // this executes on every render\n  useEffect(() => {\n    if (!outerRef) {\n      return\n    }\n    if (typeof outerRef === 'function') {\n      outerRef(ref.current)\n    } else {\n      outerRef.current = ref.current\n    }\n  })\n\n  return ref\n}\n\nexport function useAfterMountEffect(\n  nextOnLayout: ViewProps['onLayout'],\n  effect: React.EffectCallback\n) {\n  const didExecute = useRef(false)\n  const didMount = useSharedValue(false)\n\n  useAnimatedReaction(\n    () => {\n      return didMount.value\n    },\n    (didMount, prevDidMount) => {\n      if (didMount && !prevDidMount) {\n        if (didExecute.current) return\n\n        effect()\n        didExecute.current = true\n      }\n    }\n  )\n\n  const onLayoutOut: NonNullable<ViewProps['onLayout']> = useCallback(\n    (event: LayoutChangeEvent) => {\n      requestAnimationFrame(() => {\n        didMount.value = true\n      })\n      return nextOnLayout?.(event)\n    },\n    [didMount, nextOnLayout]\n  )\n\n  return onLayoutOut\n}\n\nexport function useConvertAnimatedToValue<T>(\n  animatedValue: Animated.SharedValue<T>\n) {\n  const [value, setValue] = useState<T>(animatedValue.value)\n\n  useAnimatedReaction(\n    () => {\n      return animatedValue.value\n    },\n    (animValue) => {\n      if (animValue !== value) {\n        runOnJS(setValue)(animValue)\n      }\n    },\n    [value]\n  )\n\n  return value || 0\n}\n\nexport interface HeaderMeasurements {\n  /**\n   * Animated value that represents the current Y translation of the header\n   */\n  top: Animated.SharedValue<number>\n  /**\n   * Animated value that represents the height of the header\n   */\n  height: number\n}\n\nexport function useHeaderMeasurements(): HeaderMeasurements {\n  const { headerTranslateY, headerHeight } = useTabsContext()\n  return {\n    top: headerTranslateY,\n    height: headerHeight,\n  }\n}\n\n/**\n * Returns the vertical scroll position of the current tab as an Animated SharedValue\n */\nexport function useCurrentTabScrollY(): Animated.SharedValue<number> {\n  const { scrollYCurrent } = useTabsContext()\n  return scrollYCurrent\n}\n\n/**\n * Returns the currently focused tab name\n */\nexport function useFocusedTab() {\n  const { focusedTab } = useTabsContext()\n  const focusedTabValue = useConvertAnimatedToValue(focusedTab)\n  return focusedTabValue\n}\n\n/**\n * Returns an animated value representing the current tab index, as a floating point number\n */\nexport function useAnimatedTabIndex() {\n  const { indexDecimal } = useTabsContext()\n  return indexDecimal\n}\n\nexport const usePageScrollHandler = (\n  handlers: {\n    onPageScroll: (\n      event: PagerViewOnPageScrollEvent['nativeEvent'],\n      context: unknown\n    ) => unknown\n  },\n  dependencies?: unknown[]\n) => {\n  const { context, doDependenciesDiffer } = useHandler(handlers, dependencies)\n  const subscribeForEvents = ['onPageScroll']\n\n  return useEvent<any>(\n    (event) => {\n      'worklet'\n      const { onPageScroll } = handlers\n      if (onPageScroll && event.eventName.endsWith('onPageScroll')) {\n        onPageScroll(event, context)\n      }\n    },\n    subscribeForEvents,\n    doDependenciesDiffer\n  )\n}\n"],"mappings":"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"}